/**
 * @author alexanderweiss
 * @date 12.12.2015
 */
package com.github.alexanderwe.bananaj.model.campaign;

import java.net.URL;

import org.json.JSONObject;

public class CampaignContent {

	private Campaign campaign;
	private String plainText;
	private String html;
	
	protected CampaignContent(String plain_text, String html, Campaign campaign) {
		this.campaign = campaign;
		this.plainText = plain_text;
		this.html = html;
	}

	/**
	 * Set the html content of this campaign. Plain text will be automatically generated by MailChimp
	 * @param htmlContent
	 * @throws Exception
	 */
	public void changeHTMLContent(String htmlContent) throws Exception{
		JSONObject content = new JSONObject();
		content.put("html", htmlContent);
		String response = getCampaign().getConnection().do_Put(new URL(getCampaign().getConnection().getCampaignendpoint()+"/"+this.getCampaign().getId()+"/content"),content.toString(), this.getCampaign().getConnection().getApikey());
		content = new JSONObject(response);
		this.plainText = content.has("plain_text") ? content.getString("plain_text") : null; 
		this.html = content.has("html") ? content.getString("html") : null;
	}

	/**
	 * @return the plain_text
	 */
	public String getPlainText() {
		return plainText;
	}

	/**
	 * @return the html
	 */
	public String getHtml() {
		return html;
	}

	/**
	 *
	 * @return the campaign this content belongs to
	 */
	public Campaign getCampaign() {
		return campaign;
	}

	/* (non-Javadoc)
	 * @see java.lang.Object#toString()
	 */
	@Override
	public String toString() {
		return getHtml();
	}

}
